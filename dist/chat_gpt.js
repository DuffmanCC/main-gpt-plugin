import{d as C,r as u,l as se,c as i,o as l,n as H,z as X,a as d,t as B,p as ne,b as y,e as O,w as G,f as Z,i as D,k as x,F as U,g as W,u as b,_ as K,h as le,D as fe,E as he,G as ge,m as ee,j as te,H as ve,x as N,q as be,s as xe}from"./style.js";import{p as Y}from"./tools.js";const J=C({__name:"chat-alert",props:{type:{},timeout:{default:0}},setup(o){const e=u(!0);return se(()=>{o.timeout!==0&&setTimeout(()=>{e.value=!1},o.timeout)}),(t,n)=>(l(),i("div",{class:H(["border-l-4! p-2 rounded bg-white border! text-base",{"border-blue-500! ":t.type==="info","border-orange-500! ":t.type==="warning","border-green-500! ":t.type==="success","border-red-500! ":t.type==="error",hidden:!e.value}]),role:"alert"},[X(t.$slots,"default")],2))}}),ye=["innerHTML"],ae=C({__name:"chat-bot-message",props:{isExpanded:{type:Boolean},message:{}},setup(o){return(e,t)=>(l(),i("div",{class:H(["chat-message text-base gap-4 flex flex-col from-blue-400 to-blue-500 self-end rounded-b-2xl rounded-tl-2xl bg-linear-to-b px-6 pt-1 pb-2 text-white",{"max-w-[700px]":e.isExpanded,"max-w-[414px]":!e.isExpanded}]),innerHTML:e.message},null,10,ye))}});function oe(o,e){for(let t=0;t<o.length;t++)if(!e.includes(o[t]))return!1;return!0}function re(o){return o.filter(e=>e.isMandatory).map(e=>e.id)}function Ce(o){return/^[a-zA-Z0-9._+-]+@[a-zA-Z0-9_+-]+\.[a-zA-Z]{2,}$/.test(o)}const we={class:"flex gap-2 text-black text-sm items-center relative"},_e=["id","name"],$e={href:"#",className:"underline"},ie=C({__name:"chat-checkbox",props:{id:{},name:{},isMandatory:{type:Boolean}},emits:["accepted-campaign","update:modal-id-opened"],setup(o,{emit:e}){const t=e;return(n,a)=>(l(),i("label",we,[d("input",{id:`campaign-${n.id}`,name:`campaign-${n.id}`,type:"checkbox",onChange:a[0]||(a[0]=s=>t("accepted-campaign",n.id)),class:"appearance-none! peer before:hidden! w-4! h-4! border! border-black! rounded-none! bg-white!"},null,40,_e),a[2]||(a[2]=d("svg",{class:"absolute w-4 h-4 hidden peer-checked:block",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[d("polyline",{points:"20 6 9 17 4 12"})],-1)),d("div",{class:"flex gap-2",onClick:a[1]||(a[1]=s=>t("update:modal-id-opened",n.id))},[d("a",$e,B(n.name),1)]),d("span",{class:H({"text-red-500 text-xs":n.isMandatory,hidden:!n.isMandatory})}," (mandatory) ",2)]))}}),ke=["disabled"],de=C({__name:"chat-button",props:{disabled:{type:Boolean,default:!1}},emits:["click"],setup(o,{emit:e}){const t=e;return(n,a)=>(l(),i("button",{class:H(`
      text-sm uppercase px-4 py-2 rounded-xl 
      text-white transition-color shadow-button 
      bg-blue-500 hover:bg-blue-600 active:bg-blue-700 no-underline 
      disabled:opacity-50 disabled:cursor-not-allowed
    `),onClick:a[0]||(a[0]=s=>t("click")),disabled:n.disabled},[X(n.$slots,"default")],8,ke))}}),Ae={key:0,className:"text-xl"},Fe={className:"flex justify-end"},ue=C({__name:"chat-form",props:{title:{},disabled:{type:Boolean}},emits:["submit"],setup(o,{emit:e}){const t=e;return(n,a)=>(l(),i("form",{className:"flex flex-col gap-2 text-black",onSubmit:a[0]||(a[0]=ne(s=>t("submit"),["prevent"]))},[n.title?(l(),i("div",Ae,B(n.title),1)):y("",!0),X(n.$slots,"default"),d("div",Fe,[O(de,{disabled:n.disabled,type:"submit"},{default:G(()=>a[1]||(a[1]=[Z("Accept")])),_:1},8,["disabled"])])],32))}}),Me={className:"flex flex-col gap-1"},Ie=C({__name:"chat-campaigns-form",emits:["form-accepted"],setup(o,{emit:e}){const t=D("setModalIdOpen"),n=D("chatGptData");if(!n)throw new Error("chatGptData is undefined");const{aiChatCampaigns:a}=n,s=u([]),r=u(!1),c=e;function L(h){const k=s.value.indexOf(h);k===-1?s.value=[...s.value,h]:s.value.splice(k,1),oe(re(a),s.value.map($=>$.toString()))?r.value=!0:r.value=!1}function w(){c("form-accepted",s.value)}return(h,k)=>(l(),x(J,{type:"info"},{default:G(()=>[O(ue,{title:"Campaigns From",disabled:!r.value,onSubmit:w},{default:G(()=>[d("div",Me,[(l(!0),i(U,null,W(b(a),_=>(l(),x(ie,{key:_.id,id:_.id,name:_.name,isMandatory:_.isMandatory,onAcceptedCampaign:L,"onUpdate:modalIdOpened":b(t)},null,8,["id","name","isMandatory","onUpdate:modalIdOpened"]))),128))])]),_:1},8,["disabled"])]),_:1}))}});async function Ee({ajaxUrl:o,action:e,queryField:t,aiChatterId:n,message:a,prevMessage:s,aiChatId:r,nonce:c,onMessageChunk:L}){const w=new FormData;w.append("action",e),w.append(`data[${t}]`,a),w.append("data[prevMessage]",s),w.append("data[aiChatterId]",n),w.append("security",c),r&&w.append("data[aiChatId]",r.toString());try{const h=await fetch(o,{method:"POST",body:w});if(!h.body)throw new Error("No response body.");const k=h.body.getReader(),_=new TextDecoder;for(;;){const{done:$,value:q}=await k.read();if($)break;const I=_.decode(q,{stream:!0});L(I)}}catch(h){throw console.error("Error en la peticiÃ³n:",h),h}}async function De({ajaxUrl:o,action:e,nonce:t,aiChatCampaignsField:n,campaignIds:a}){const s=new FormData;return s.append("action",e),s.append(`data[${n}][]`,a.join(",")),s.append("security",t),Y(o,s)}async function Be({ajaxUrl:o,action:e,nonce:t,message:n,aiChatId:a,role:s}){const r=new FormData;return r.append("action",e),r.append("data[aiChatMessage]",JSON.stringify({role:s,content:n})),r.append("data[aiChatId]",(a==null?void 0:a.toString())??""),r.append("security",t),Y(o,r)}async function Le({ajaxUrl:o,action:e,nonce:t,fields:n,campaignIds:a,aiChatterId:s,aiChatId:r}){const c=new FormData;return c.append("action",e),c.append("security",t),c.append("data[fields]",n),c.append("data[campaignIds][]",a.join(",")),c.append("data[aiChatterId]",s),c.append("data[aiChatId]",r),Y(o,c)}const qe={class:"flex flex-col gap-1 relative pb-4 text-base"},Oe={class:"flex gap-2 items-center"},Se={key:0,class:"text-red-500 text-xs"},je=["type","name","id","aria-errormessage"],ze={key:0,id:"`${id}-error`",class:"text-red-500 text-xs absolute bottom-0"},Ve=C({__name:"chat-input-field",props:{label:{},type:{},id:{},required:{type:Boolean},handleFilledField:{type:Function}},setup(o){const e=u(""),t=u(null);function n(s){const c=s.target.value.trim();e.value=c,a(c)}function a(s){return!s&&o.required?(t.value="This fields is required",o.handleFilledField(o.id,""),!0):o.id==="email"&&!Ce(s)?(t.value="Please enter a valid email address",o.handleFilledField(o.id,""),!0):(t.value=null,o.handleFilledField(o.id,s),!1)}return(s,r)=>(l(),i("label",qe,[d("div",Oe,[Z(B(s.label)+" ",1),s.required?(l(),i("span",Se,"(required)")):y("",!0)]),d("input",{type:s.type,name:s.id,id:s.id,class:"border border-gray-300 rounded px-2 py-1",onInput:n,"aria-errormessage":`${s.id}-error`},null,40,je),t.value?(l(),i("div",ze,B(t.value),1)):y("",!0)]))}}),Ge={class:"flex flex-col gap-1 relative pb-4 text-base"},He={class:"flex gap-2 items-center"},Te={key:0,class:"text-red-500 text-xs"},Ne=["name","id","aria-errormessage"],Ue=["id"],Qe=C({__name:"chat-textarea-field",props:{id:{},label:{},required:{type:Boolean},handleFilledField:{type:Function}},setup(o){const e=o,t=u(""),n=u(null);function a(r){r.preventDefault();const c=r.target;t.value=c.value}function s(){if(!t.value&&e.required){n.value="This fields is required";return}t.value&&(e.handleFilledField(e.id,t.value),n.value=null)}return(r,c)=>(l(),i("label",Ge,[d("div",He,[Z(B(r.label)+" ",1),r.required?(l(),i("span",Te,"(required)")):y("",!0)]),d("textarea",{name:r.id,id:r.id,class:"border border-gray-300 rounded px-2 py-1 min-h-[100px]",onChange:a,onBlur:s,"aria-errormessage":`${r.id}-error`},null,40,Ne),d("div",{id:`${r.id}-error`,class:"text-red-500 text-xs absolute bottom-0"},B(n.value),9,Ue)]))}}),Ze={key:1,className:"flex flex-col gap-1"},Re=C({__name:"chat-contact-form",setup(o){const e=D("chatGptData");if(!e)throw new Error("Missing dependencies");const t=D("setModalIdOpen"),n=D("setAllowChatInput"),a=D("aiChatId"),s=D("setIsAcceptedAiContactForm"),r=D("setErrorMessage"),{aiContactCampaigns:c,formFields:L,ajaxUrl:w,ajaxActionCreateAiContact:h,nonce:k,aiChatterId:_,allowAiContactCampaigns:$,afterFormMessageError:q}=e,I=u([]),A=u(!1),E=u(!1),p=u(null),m=u({name:"",email:"",phone:"",message:""});function S(g){const T=I.value.indexOf(g);T===-1?I.value=[...I.value,g]:I.value.splice(T,1),oe(re(c),I.value.map(V=>V.toString()))?E.value=!0:E.value=!1}function j(g,T){m.value={...m.value,[g]:T},L.filter(V=>V.required&&V.active).every(V=>m.value[V.label.toLowerCase()])?A.value=!0:A.value=!1}async function Q(){if(!a)return;const g=await Le({ajaxUrl:w,action:h,nonce:k,fields:JSON.stringify(m),campaignIds:I.value,aiChatterId:_,aiChatId:a});g.success?(p.value=g.data.aiContadId,s(!0),n(!1),r("")):(n(!1),r(q))}const R=L.filter(g=>g.active),P=R.filter(g=>g.type!=="textarea"),z=R.find(g=>g.type==="textarea");return se(()=>{(c.length===0||!$)&&(E.value=!0)}),(g,T)=>(l(),x(J,{type:"info",class:"mb-4"},{default:G(()=>[O(ue,{title:"Ai Contact Form",disabled:!E.value||!A.value,onSubmit:Q},{default:G(()=>[(l(!0),i(U,null,W(b(P),F=>(l(),x(Ve,{key:F.label,label:F.label,type:F.type,id:F.label.toLowerCase(),required:F.required,handleFilledField:j},null,8,["label","type","id","required"]))),128)),b(z)?(l(),x(Qe,{key:0,label:b(z).label,id:b(z).label.toLowerCase(),required:b(z).required,handleFilledField:j},null,8,["label","id","required"])):y("",!0),b($)?(l(),i("div",Ze,[(l(!0),i(U,null,W(b(c),F=>(l(),x(ie,{key:F.id,id:F.id,name:F.name,isMandatory:F.isMandatory,onAcceptedCampaign:S,"onUpdate:modalIdOpened":b(t)},null,8,["id","name","isMandatory","onUpdate:modalIdOpened"]))),128))])):y("",!0)]),_:1},8,["disabled"])]),_:1}))}}),Pe={},Je={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"currentColor"};function We(o,e){return l(),i("svg",Je,e[0]||(e[0]=[d("path",{d:"M16.1 260.2c-22.6 12.9-20.5 47.3 3.6 57.3L160 376V479.3c0 18.1 14.6 32.7 32.7 32.7c9.7 0 18.9-4.3 25.1-11.8l62-74.3 123.9 51.6c18.9 7.9 40.8-4.5 43.9-24.7l64-416c1.9-12.1-3.4-24.3-13.5-31.2s-23.3-7.5-34-1.4l-448 256zm52.1 25.5L409.7 90.6 190.1 336l1.2 1L68.2 285.7zM403.3 425.4L236.7 355.9 450.8 116.6 403.3 425.4z"},null,-1)]))}const Ke=K(Pe,[["render",We]]),Xe=["disabled"],Ye={class:"w-10 h-10 border rounded-full border-gray-400 flex justify-center items-center bg-white! disabled:opacity-30 disabled:cursor-not-allowed focus:outline-hidden focus:ring-2 focus:ring-blue-500"},et=C({__name:"chat-footer",props:{allowChatInput:{type:Boolean},aiChatId:{},remainingQuestions:{}},emits:["update:remaining-questions","update:messages","update:error-message"],setup(o,{emit:e}){const t=D("chatGptData");if(!t)throw new Error("chatGptData is undefined");const n=D("setAllowChatInput");if(!n)throw new Error("setAllowChatInput is undefined");const{ajaxUrl:a,ajaxActionChatBot:s,nonce:r,queryField:c,aiChatterId:L,ajaxActionRecordAiChat:w}=t,h=o,k=e,_=u(!1),$=u(""),q=u(""),I=u("");async function A(){if(_.value=!0,!!$.value){q.value="",E($.value,"user");try{await Ee({ajaxUrl:a,action:s,queryField:c,aiChatterId:L,message:$.value,prevMessage:I.value,aiChatId:h.aiChatId,nonce:r,onMessageChunk:p=>{q.value+=p,k("update:messages",{message:p,type:"system"})}}),E(q.value,"system"),I.value=q.value}catch(p){const m=p instanceof Error?p.message:"Error sending message";k("update:error-message",m)}finally{_.value=!1,$.value=""}}}async function E(p,m){m==="system"&&k("update:remaining-questions",h.remainingQuestions-1),h.aiChatId&&await Be({ajaxUrl:a,action:w,nonce:r,message:p,aiChatId:h.aiChatId,role:m}),h.remainingQuestions===0&&n(!1),k("update:messages",{message:p,type:m})}return(p,m)=>(l(),i("form",{class:"flex mb-6 sm:mb-0 gap-2",onSubmit:ne(A,["prevent"]),name:"chat-footer"},[le(d("input",{type:"text",id:"message","onUpdate:modelValue":m[0]||(m[0]=S=>$.value=S),disabled:_.value||!p.allowChatInput,class:"grow align-center border-gray-400! flex rounded-full! border! px-6! pt-1! pb-2! text-base! shadow-lg disabled:opacity-30 disabled:cursor-not-allowed focus:outline-hidden focus:ring-2 focus:ring-blue-500"},null,8,Xe),[[fe,$.value]]),d("button",Ye,[O(Ke,{class:"w-6 h-6 text-gray-400"})])],32))}}),tt={},at={xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 512 512"};function st(o,e){return l(),i("svg",at,e[0]||(e[0]=[d("path",{d:"M200 32H56C42.7 32 32 42.7 32 56V200c0 9.7 5.8 18.5 14.8 22.2s19.3 1.7 26.2-5.2l40-40 79 79-79 79L73 295c-6.9-6.9-17.2-8.9-26.2-5.2S32 302.3 32 312V456c0 13.3 10.7 24 24 24H200c9.7 0 18.5-5.8 22.2-14.8s1.7-19.3-5.2-26.2l-40-40 79-79 79 79-40 40c-6.9 6.9-8.9 17.2-5.2 26.2s12.5 14.8 22.2 14.8H456c13.3 0 24-10.7 24-24V312c0-9.7-5.8-18.5-14.8-22.2s-19.3-1.7-26.2 5.2l-40 40-79-79 79-79 40 40c6.9 6.9 17.2 8.9 26.2 5.2s14.8-12.5 14.8-22.2V56c0-13.3-10.7-24-24-24H312c-9.7 0-18.5 5.8-22.2 14.8s-1.7 19.3 5.2 26.2l40 40-79 79-79-79 40-40c6.9-6.9 8.9-17.2 5.2-26.2S209.7 32 200 32z"},null,-1)]))}const nt=K(tt,[["render",st]]),lt={},ot={xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 512 512"};function rt(o,e){return l(),i("svg",ot,e[0]||(e[0]=[d("path",{d:"M456 224H312c-13.3 0-24-10.7-24-24V56c0-9.7 5.8-18.5 14.8-22.2s19.3-1.7 26.2 5.2l40 40L442.3 5.7C446 2 450.9 0 456 0s10 2 13.7 5.7l36.7 36.7C510 46 512 50.9 512 56s-2 10-5.7 13.7L433 143l40 40c6.9 6.9 8.9 17.2 5.2 26.2s-12.5 14.8-22.2 14.8zm0 64c9.7 0 18.5 5.8 22.2 14.8s1.7 19.3-5.2 26.2l-40 40 73.4 73.4c3.6 3.6 5.7 8.5 5.7 13.7s-2 10-5.7 13.7l-36.7 36.7C466 510 461.1 512 456 512s-10-2-13.7-5.7L369 433l-40 40c-6.9 6.9-17.2 8.9-26.2 5.2s-14.8-12.5-14.8-22.2V312c0-13.3 10.7-24 24-24H456zm-256 0c13.3 0 24 10.7 24 24V456c0 9.7-5.8 18.5-14.8 22.2s-19.3 1.7-26.2-5.2l-40-40L69.7 506.3C66 510 61.1 512 56 512s-10-2-13.7-5.7L5.7 469.7C2 466 0 461.1 0 456s2-10 5.7-13.7L79 369 39 329c-6.9-6.9-8.9-17.2-5.2-26.2s12.5-14.8 22.2-14.8H200zM56 224c-9.7 0-18.5-5.8-22.2-14.8s-1.7-19.3 5.2-26.2l40-40L5.7 69.7C2 66 0 61.1 0 56s2-10 5.7-13.7L42.3 5.7C46 2 50.9 0 56 0s10 2 13.7 5.7L143 79l40-40c6.9-6.9 17.2-8.9 26.2-5.2s14.8 12.5 14.8 22.2V200c0 13.3-10.7 24-24 24H56z"},null,-1)]))}const it=K(lt,[["render",rt]]),dt=C({__name:"chat-maximize-button",props:{isExpanded:{type:Boolean}},emits:["expand-chat"],setup(o,{emit:e}){const t=e;function n(a){a.stopPropagation(),t("expand-chat")}return(a,s)=>(l(),i("button",{onClick:s[0]||(s[0]=r=>t("expand-chat")),class:"absolute top-2 sm:-top-12 left-0 hidden sm:block"},[O(nt,{onClick:n,class:H(["h-6 w-6 sm:w-10 sm:h-10 text-blue-500",{block:!a.isExpanded,"hidden!":a.isExpanded}])},null,8,["class"]),O(it,{onClick:n,class:H(["h-6 w-6 sm:w-10 sm:h-10 text-blue-500",{block:a.isExpanded,"hidden!":!a.isExpanded}])},null,8,["class"])]))}}),ut={class:"fixed z-40 inset-0 w-full h-full bg-black justify-center items-center flex bg-opacity-50",tabindex:"-1"},ct={class:"bg-white rounded w-full max-w-lg min-w-md h-96 flex flex-col"},pt={class:"p-4 border-b"},mt=["innerHTML"],ft={class:"flex justify-end border-t p-4"},ht=C({__name:"chat-modal",props:{id:{},name:{},content:{},isVisible:{type:Boolean}},emits:["close-modal"],setup(o,{emit:e}){const t=e;function n(a){t("close-modal",a)}return(a,s)=>le((l(),i("div",ut,[d("div",ct,[d("header",pt,B(a.name),1),d("main",{class:"grow p-4 overflow-y-scroll",innerHTML:a.content},null,8,mt),d("footer",ft,[O(de,{onClick:s[0]||(s[0]=r=>n(a.id))},{default:G(()=>s[1]||(s[1]=[Z("Close")])),_:1})])])],512)),[[he,a.isVisible]])}}),gt={},vt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"413",height:"413",viewBox:"0 0 413 413"};function bt(o,e){return l(),i("svg",vt,e[0]||(e[0]=[ge('<defs><linearGradient id="hall-9000-gradient" x1="1" y1="1" x2="0.081" y2="0.124" gradientUnits="objectBoundingBox"><stop offset="0" stop-color="#6d86d6"></stop><stop offset="1" stop-color="#48c4ee"></stop></linearGradient></defs><rect fill="url(#hall-9000-gradient)" width="413" height="413" rx="206.5"></rect><circle fill="#fff" cx="74.189" cy="74.189" r="74.189" transform="translate(131.178 134.023)"></circle><circle fill="#fff" cx="35.382" cy="35.382" r="35.382" transform="translate(278.414 96.358)"></circle><path fill="#fff" d="M132.445,0C61.11,0,2.9,58.209,2.9,129.545S61.11,259.089,132.445,259.089,261.989,200.88,261.989,129.545,203.78,0,132.445,0Zm0,245.393A115.848,115.848,0,1,1,248.293,129.545,115.932,115.932,0,0,1,132.445,245.393Z" transform="translate(72.922 76.955)"></path>',5)]))}const xt=K(gt,[["render",bt]]),yt=C({__name:"chat-open-button",emits:["open-chat"],setup(o,{emit:e}){const t=e;return(n,a)=>(l(),i("button",{onClick:a[1]||(a[1]=s=>t("open-chat")),class:"fixed bottom-2 right-2 sm:bottom-6 sm:right-6 z-20"},[O(xt,{class:"w-8 h-8 sm:w-16 sm:h-16 rounded-full duration-300 hover:rotate-90",onClick:a[0]||(a[0]=s=>t("open-chat"))})]))}}),Ct={class:"absolute sm:-top-12 right-0 items-center justify-center gap-2 rounded-2xl bg-white pl-2 pr-4 shadow-lg hidden sm:flex"},wt={class:"relative -top-1 text-4xl font-bold"},_t=C({__name:"chat-tokens",props:{ramainingQuestions:{}},setup(o){return(e,t)=>(l(),i(U,null,[d("div",Ct,[t[0]||(t[0]=d("div",{class:"bg-blue-500 h-8 w-8 rounded-full"},null,-1)),t[1]||(t[1]=d("div",{class:"relative -top-1 text-2xl"},"tokens left",-1)),d("div",wt,B(e.ramainingQuestions),1)]),t[2]||(t[2]=d("div",{class:"absolute bottom-2 left-4 sm:hidden"}," {ramainingQuestions} tokens left ",-1))],64))}}),$t=["innerHTML"],kt=C({__name:"chat-user-message",props:{isExpanded:{type:Boolean},message:{}},setup(o){return(e,t)=>(l(),i("div",{class:H(["from-gray-200 text-base to-gray-300 border-gray-400 text-gray-700 rounded-t-2xl rounded-br-2xl border bg-linear-to-t px-6 pt-1 pb-2",{"max-w-[700px]":e.isExpanded,"max-w-[414px]":!e.isExpanded}]),innerHTML:e.message},null,10,$t))}}),At=C({__name:"chat-gpt",setup(o){const e=D("chatGptData");if(!e)throw new Error("chatGptData is undefined");const{isActive:t,initMessage:n,campaigns:a,limitChat:s,hasAiChat:r,ajaxUrl:c,ajaxActionCreateAiChat:L,nonce:w,aiChatCampaignsField:h,beforeFormMessage:k,questionsLimit:_,aiChatCampaigns:$,afterFormMessageSuccess:q,allowAiChatCampaigns:I}=e,A=u(!1),E=u(null),p=u(!1),m=u(_),S=u(null),j=u(!1),Q=u(!1),R=u(!1),P=u([]),z=u(null),g=u(null);N("aiChatId",S),N("setAiChatId",f=>{S.value=f}),N("setModalIdOpen",f=>{E.value=f}),N("setIsAcceptedAiChatForm",f=>{Q.value=f}),N("setIsAcceptedAiContactForm",f=>{R.value=f}),N("setAllowChatInput",f=>{j.value=f}),N("setErrorMessage",f=>{g.value=f});async function T(f){const v=await De({ajaxUrl:c,action:L,nonce:w,aiChatCampaignsField:h,campaignIds:f});v.success?(S.value=v.data.aiChatId,Q.value=!0,j.value=!0):console.error(v.error)}ee(A,()=>{A.value&&!S.value&&r&&!I&&(T([]),j.value=!0),A.value&&!r&&(Q.value=!0,j.value=!0)});const F=te(()=>!Q.value&&r&&$.length>0),V=te(()=>m.value===0&&!R.value&&s);function pe(f){if(!f.message.includes("[DONE]"))if(f.type==="system"){const v=P.value.at(-1);v&&v.type==="system"?v.message+=f.message:P.value.push({message:f.message,type:"system"})}else P.value.push({message:f.message,type:"user"})}function me(){z.value&&(z.value.scrollTop=z.value.scrollHeight)}return ee(m,()=>{m.value===0&&(j.value=!1)}),ve(()=>{me()}),(f,v)=>(l(),i(U,null,[b(t)?(l(),i("div",{key:0,class:H(["inset-0 w-full h-full bg-black/70 justify-center items-center flex z-20 font-arboria font-normal",{hidden:!A.value,fixed:A.value}])},[d("div",{class:H(["relative flex flex-col text-xl w-full h-full min-h-full p-4 sm:p-6 border-2 sm:border-gray-300 sm:rounded-3xl shadow-card bg-white",{"sm:h-5/6 sm:w-[900px] sm:min-h-[600px] mx-4":p.value,"sm:h-4/6 sm:w-[537px] sm:min-h-[500px]":!p.value}])},[d("div",{class:"flex grow flex-col gap-3 sm:gap-7 overflow-y-auto mb-4",ref_key:"chatContainer",ref:z},[F.value?(l(),x(Ie,{key:0,onFormAccepted:T})):y("",!0),Q.value?(l(),x(ae,{key:1,message:b(n),isExpanded:p.value},null,8,["message","isExpanded"])):y("",!0),(l(!0),i(U,null,W(P.value,M=>(l(),i(U,null,[M.type==="user"?(l(),x(kt,{key:0,message:M.message,isExpanded:p.value},null,8,["message","isExpanded"])):(l(),x(ae,{key:1,message:M.message,isExpanded:p.value},null,8,["message","isExpanded"]))],64))),256)),V.value?(l(),x(J,{key:2,type:"warning"},{default:G(()=>[Z(B(b(k)),1)]),_:1})):y("",!0),V.value?(l(),x(Re,{key:3})):y("",!0),R.value?(l(),x(J,{key:4,type:"success"},{default:G(()=>[Z(B(b(q)),1)]),_:1})):y("",!0),g.value?(l(),x(J,{key:5,type:"error"},{default:G(()=>[Z(B(g.value),1)]),_:1})):y("",!0)],512),O(et,{allowChatInput:j.value,aiChatId:S.value,remainingQuestions:m.value,"onUpdate:remainingQuestions":v[0]||(v[0]=M=>m.value=M),"onUpdate:messages":pe,"onUpdate:errorMessage":v[1]||(v[1]=M=>g.value=M)},null,8,["allowChatInput","aiChatId","remainingQuestions"]),b(s)?(l(),x(_t,{key:0,ramainingQuestions:m.value},null,8,["ramainingQuestions"])):y("",!0),O(dt,{isExpanded:p.value,onExpandChat:v[2]||(v[2]=M=>p.value=!p.value)},null,8,["isExpanded"])],2)],2)):y("",!0),b(t)?(l(!0),i(U,{key:1},W(b(a),M=>(l(),x(ht,{name:M.name,content:M.content,id:M.id,isVisible:M.id===E.value,onCloseModal:v[3]||(v[3]=Mt=>E.value=null)},null,8,["name","content","id","isVisible"]))),256)):y("",!0),b(t)?(l(),x(yt,{key:2,onClick:v[4]||(v[4]=M=>A.value=!A.value),isOpen:A.value},null,8,["isOpen"])):y("",!0)],64))}});let ce={};ce=window.chat_gpt.data;const Ft=be({setup(){N("chatGptData",ce)},render:()=>xe(At)});Ft.mount("#maingpt_chat");
