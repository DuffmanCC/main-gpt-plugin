import{d as k,r as w,l as at,c,o as s,n as U,z as X,a as d,t as B,p as nt,b as $,e as L,w as V,f as P,i as j,k as y,F as N,g as W,u as f,_ as K,h as st,D as pt,E as ht,G as ft,m as Y,j as tt,H as gt,x as H,q as xt,s as vt}from"./wug-style.js";function ot(t,a){for(let e=0;e<t.length;e++)if(!a.includes(t[e]))return!1;return!0}function it(t){return t.filter(a=>a.isMandatory).map(a=>a.id)}function bt(t){return/^[a-zA-Z0-9._+-]+@[a-zA-Z0-9_+-]+\.[a-zA-Z]{2,}$/.test(t)}const J=k({__name:"chat-alert",props:{type:{type:String,default:"info"},timeout:{type:Number,default:0}},setup(t){const a=t,e=w(!0);return at(()=>{a.timeout!==0&&setTimeout(()=>{e.value=!1},a.timeout)}),(o,n)=>(s(),c("div",{class:U(["tw:border-l-4 tw:p-2 tw:rounded tw:bg-white tw:border tw:text-base",{"tw:border-blue-500 ":t.type==="info","tw:border-orange-500 ":t.type==="warning","tw:border-green-500 ":t.type==="success","tw:border-red-500 ":t.type==="error","tw:hidden":!e.value}]),role:"alert"},[X(o.$slots,"default")],2))}}),_t={class:"tw:flex tw:gap-2 tw:text-black tw:text-sm tw:items-center tw:relative"},yt=["id","name"],Ct=d("svg",{class:"tw:absolute tw:w-4 tw:h-4 tw:hidden tw:peer-checked:block",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[d("polyline",{points:"20 6 9 17 4 12"})],-1),$t={href:"#",className:"tw:underline"},rt=k({__name:"chat-checkbox",props:{id:String,name:String,isMandatory:Boolean},emits:["accepted-campaign","update:modal-id-opened"],setup(t,{emit:a}){const e=a;return(o,n)=>(s(),c("label",_t,[d("input",{id:`campaign-${t.id}`,name:`campaign-${t.id}`,type:"checkbox",onChange:n[0]||(n[0]=r=>e("accepted-campaign",t.id)),class:"tw:appearance-none! tw:peer tw:before:hidden! tw:w-4! tw:h-4! tw:border! tw:border-black! tw:rounded-none! tw:bg-white!"},null,40,yt),Ct,d("div",{class:"tw:flex tw:gap-2",onClick:n[1]||(n[1]=r=>e("update:modal-id-opened",t.id))},[d("a",$t,B(t.name),1)]),d("span",{class:U({"tw:text-red-500 tw:text-xs":t.isMandatory,"tw:hidden":!t.isMandatory})}," (mandatory) ",2)]))}}),kt=["disabled"],lt=k({__name:"chat-button",props:{disabled:Boolean},emits:["click"],setup(t,{emit:a}){const e=a;return(o,n)=>(s(),c("button",{class:"tw:text-sm tw:uppercase tw:px-4 tw:py-3 tw:rounded-xl tw:text-white tw:transition-all tw:duration-300 tw:shadow-button tw:bg-blue-500 tw:hover:bg-blue-600 tw:active:bg-blue-700 tw:no-underline tw:disabled:opacity-50 tw:disabled:cursor-not-allowed",onClick:n[0]||(n[0]=r=>e("click")),disabled:t.disabled},[X(o.$slots,"default")],8,kt))}}),At=["id","name"],Mt={key:0,className:"tw:text-xl"},Ft={className:"tw:flex tw:justify-end"},ct=k({__name:"chat-form",props:{title:String,disabled:Boolean,accept:Function,id:String},emits:["submit"],setup(t,{emit:a}){const e=a;return(o,n)=>(s(),c("form",{id:t.id,name:t.id,className:"tw:flex tw:flex-col tw:gap-2 tw:text-black",onSubmit:n[0]||(n[0]=nt(r=>e("submit"),["prevent"]))},[t.title?(s(),c("div",Mt,B(t.title),1)):$("",!0),X(o.$slots,"default"),d("div",Ft,[L(lt,{disabled:t.disabled,type:"submit"},{default:V(()=>[P("Accept")]),_:1},8,["disabled"])])],40,At))}}),It={className:"tw:flex tw:flex-col tw:gap-1"},Et=k({__name:"chat-ai-chat-form",emits:["form-accepted"],setup(t,{emit:a}){const e=j("setModalIdOpen"),o=j("chatGptData");if(!o)throw new Error("chatGptData is undefined");const{aiChatCampaigns:n}=o,r=w([]),i=w(!1),l=a;function m(p){const _=r.value.indexOf(p);_===-1?r.value=[...r.value,p]:r.value.splice(_,1),ot(it(n),r.value.map(M=>M.toString()))?i.value=!0:i.value=!1}function u(){l("form-accepted",r.value)}return(p,_)=>(s(),y(J,{type:"info"},{default:V(()=>[L(ct,{id:"ai-chat-campaigns-form",title:"Ai Chat Campaigns",disabled:!i.value,onSubmit:u},{default:V(()=>[d("div",It,[(s(!0),c(N,null,W(f(n),A=>(s(),y(rt,{key:A.id,id:A.id,name:A.name,isMandatory:A.isMandatory,onAcceptedCampaign:m,"onUpdate:modalIdOpened":f(e)},null,8,["id","name","isMandatory","onUpdate:modalIdOpened"]))),128))])]),_:1},8,["disabled"])]),_:1}))}}),St=async({ajaxUrl:t,action:a,queryField:e,aiChatterId:o,message:n,prevMessage:r,aiChatId:i,nonce:l,onMessageChunk:m})=>{const u=new FormData;u.append("action",a),u.append(`data[${e}]`,n),u.append("data[prevMessage]",r),u.append("data[aiChatterId]",o),u.append("security",l),i&&u.append("data[aiChatId]",i.toString());try{const p=await fetch(t,{method:"POST",body:u});if(!p.body)throw new Error("No se pudo leer el cuerpo de la respuesta.");const _=p.body.getReader(),A=new TextDecoder;let M="";for(;;){const{done:D,value:E}=await _.read();if(D)break;const C=A.decode(E,{stream:!0});m(C)}return M}catch(p){throw console.error("Error en la peticiÃ³n:",p),p}};async function jt({ajaxUrl:t,action:a,nonce:e,aiChatCampaigns:o,campaignIds:n}){const r=new FormData;r.append("action",a),r.append(`data[${o}][]`,n.join(",")),r.append("security",e);try{const i=await fetch(t,{method:"POST",body:r});if(!i.ok){const l=await i.json(),m=l.message?l.message:"Unknown error";throw new Error(m)}return await i.json()}catch(i){throw i}}async function Bt({ajaxUrl:t,action:a,nonce:e,message:o,aiChatId:n,role:r}){const i=new FormData;i.append("action",a),i.append("data[aiChatMessage]",JSON.stringify({role:r,content:o})),i.append("data[aiChatId]",(n==null?void 0:n.toString())??""),i.append("security",e);try{const l=await fetch(t,{method:"POST",body:i});if(!l.ok){const m=await l.json(),u=m.message?m.message:"Unknown error";throw new Error(u)}return await l.json()}catch(l){throw l}}async function Dt({ajaxUrl:t,action:a,nonce:e,fields:o,campaignIds:n,aiChatterId:r,aiChatId:i}){const l=new FormData;l.append("action",a),l.append("security",e),l.append("data[fields]",o),l.append("data[campaignIds]",n.join(",")),l.append("data[aiChatterId]",r),l.append("data[aiChatId]",i);try{const m=await fetch(t,{method:"POST",body:l});if(!m.ok){const u=await m.json(),p=u.message?u.message:"Unknown error";throw new Error(p)}return await m.json()}catch(m){throw m}}const Lt={class:"tw:flex tw:flex-col tw:gap-1 tw:relative tw:pb-4 tw:text-base"},Ot={class:"tw:flex tw:gap-2 tw:items-center"},qt={key:0,class:"tw:text-red-500 tw:text-xs"},Tt=["type","name","id","aria-errormessage"],zt={key:0,id:"`${id}-error`",class:"tw:text-red-500 tw:text-xs tw:absolute tw:bottom-0"},Vt=k({__name:"chat-input-field",props:{label:String,type:String,id:String,required:Boolean,handleFilledField:Function},setup(t){const a=t,{handleFilledField:e,id:o,required:n}=a,r=w(""),i=w(null);function l(u){const _=u.target.value.trim();r.value=_,m(_)}function m(u){return!u&&n?(i.value="This fields is required",e(o,""),!0):o==="email"&&!bt(u)?(i.value="Please enter a valid email address",e(o,""),!0):(i.value=null,e(o,u),!1)}return(u,p)=>(s(),c("label",Lt,[d("div",Ot,[P(B(t.label)+" ",1),f(n)?(s(),c("span",qt,"(required)")):$("",!0)]),d("input",{type:t.type,name:f(o),id:f(o),class:"tw:border tw:border-gray-300 tw:rounded tw:px-2 tw:py-1",onInput:l,"aria-errormessage":`${f(o)}-error`},null,40,Tt),i.value?(s(),c("div",zt,B(i.value),1)):$("",!0)]))}}),Gt={class:"tw:flex tw:flex-col tw:gap-1 tw:relative tw:pb-4 tw:text-base"},Ht={class:"tw:flex tw:gap-2 tw:items-center"},Nt={key:0,class:"tw:text-red-500 tw:text-xs"},Ut=["name","id","aria-errormessage"],Qt=["id"],Pt=k({__name:"chat-textarea-field",props:{label:String,id:String,required:Boolean,handleFilledField:Function},setup(t){const a=t,e=w(""),o=w(null);function n(i){i.preventDefault();const l=i.target;e.value=l.value}function r(){if(!e.value&&a.required){o.value="This fields is required";return}e.value&&(a.handleFilledField(a.id,e.value),o.value=null)}return(i,l)=>(s(),c("label",Gt,[d("div",Ht,[P(B(t.label)+" ",1),t.required?(s(),c("span",Nt,"(required)")):$("",!0)]),d("textarea",{name:t.id,id:t.id,class:"tw:border tw:border-gray-300 tw:rounded tw:px-2 tw:py-1 tw:min-h-[100px]",onChange:n,onBlur:r,"aria-errormessage":`${t.id}-error`},null,40,Ut),d("div",{id:`${t.id}-error`,class:"tw:text-red-500 tw:text-xs tw:absolute tw:bottom-0"},B(o.value),9,Qt)]))}}),Rt={key:1,className:"tw:flex tw:flex-col tw:gap-1"},Zt=k({__name:"chat-ai-contact-form",setup(t){const a=j("chatGptData");if(!a)throw new Error("Missing dependencies");const e=j("setModalIdOpen"),o=j("setAllowChatInput"),n=j("aiChatId"),r=j("setIsAcceptedAiContactForm"),i=j("setErrorMessage"),{aiContactCampaigns:l,formFields:m,ajaxUrl:u,ajaxActionCreateAiContact:p,nonce:_,aiChatterId:A,allowAiContactCampaigns:M,afterFormMessageError:D}=a,E=w([]),C=w(!1),S=w(!1),g=w(null),x=w({name:"",email:"",phone:"",message:""});function O(v){const G=E.value.indexOf(v);G===-1?E.value=[...E.value,v]:E.value.splice(G,1),ot(it(l),E.value.map(z=>z.toString()))?S.value=!0:S.value=!1}function q(v,G){x.value={...x.value,[v]:G},m.filter(z=>z.required&&z.active).every(z=>x.value[z.label.toLowerCase()])?C.value=!0:C.value=!1}async function Q(){if(n)try{const v=await Dt({ajaxUrl:u,action:p,nonce:_,fields:JSON.stringify(x),campaignIds:E.value,aiChatterId:A,aiChatId:n});g.value=v,r(!0),o(!1),i("")}catch{o(!1),i(D)}}const R=m.filter(v=>v.active),Z=R.filter(v=>v.type!=="textarea"),T=R.find(v=>v.type==="textarea");return at(()=>{(l.length===0||!M)&&(S.value=!0)}),(v,G)=>(s(),y(J,{type:"info",class:"tw:mb-4"},{default:V(()=>[L(ct,{title:"Ai Contact Form",disabled:!S.value||!C.value,onSubmit:Q},{default:V(()=>[(s(!0),c(N,null,W(f(Z),F=>(s(),y(Vt,{key:F.label,label:F.label,type:F.type,id:F.label.toLowerCase(),required:F.required,handleFilledField:q},null,8,["label","type","id","required"]))),128)),f(T)?(s(),y(Pt,{key:0,label:f(T).label,id:f(T).label.toLowerCase(),required:f(T).required,handleFilledField:q},null,8,["label","id","required"])):$("",!0),f(M)?(s(),c("div",Rt,[(s(!0),c(N,null,W(f(l),F=>(s(),y(rt,{key:F.id,id:F.id,name:F.name,isMandatory:F.isMandatory,onAcceptedCampaign:O,"onUpdate:modalIdOpened":f(e)},null,8,["id","name","isMandatory","onUpdate:modalIdOpened"]))),128))])):$("",!0)]),_:1},8,["disabled"])]),_:1}))}}),Jt=["innerHTML"],et=k({__name:"chat-bot-message",props:{isExpanded:Boolean,message:String},setup(t){return(a,e)=>(s(),c("div",{class:U(["chat-message tw:text-base tw:gap-4 tw:flex tw:flex-col tw:from-blue-400 tw:to-blue-500 tw:self-end tw:rounded-b-2xl tw:rounded-tl-2xl tw:bg-linear-to-b tw:px-6 tw:pt-1 tw:pb-2 tw:text-white",{"max-w-[700px]":t.isExpanded,"max-w-[414px]":!t.isExpanded}]),innerHTML:t.message},null,10,Jt))}}),Wt={},Kt={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"currentColor"},Xt=d("path",{d:"M16.1 260.2c-22.6 12.9-20.5 47.3 3.6 57.3L160 376V479.3c0 18.1 14.6 32.7 32.7 32.7c9.7 0 18.9-4.3 25.1-11.8l62-74.3 123.9 51.6c18.9 7.9 40.8-4.5 43.9-24.7l64-416c1.9-12.1-3.4-24.3-13.5-31.2s-23.3-7.5-34-1.4l-448 256zm52.1 25.5L409.7 90.6 190.1 336l1.2 1L68.2 285.7zM403.3 425.4L236.7 355.9 450.8 116.6 403.3 425.4z"},null,-1),Yt=[Xt];function te(t,a){return s(),c("svg",Kt,Yt)}const ee=K(Wt,[["render",te]]),ae=["disabled"],ne={class:"tw:w-10 tw:h-10 tw:border tw:rounded-full tw:border-gray-400 tw:flex tw:justify-center tw:items-center tw:bg-white! tw:disabled:opacity-30 tw:disabled:cursor-not-allowed tw:focus:outline-hidden tw:focus:ring-2 tw:focus:ring-blue-500"},se=k({__name:"chat-footer",props:{allowChatInput:{type:Boolean},aiChatId:{},remainingQuestions:{}},emits:["update:remaining-questions","update:messages","update:error-message"],setup(t,{emit:a}){const e=j("chatGptData");if(!e)throw new Error("chatGptData is undefined");const o=j("setAllowChatInput");if(!o)throw new Error("setAllowChatInput is undefined");const{ajaxUrl:n,ajaxActionChatBot:r,nonce:i,queryField:l,aiChatterId:m,ajaxActionRecordAiChat:u}=e,p=t,_=a,A=w(!1),M=w(""),D=w(""),E=w("");async function C(){if(A.value=!0,!!M.value){D.value="",S(M.value,"user");try{await St({ajaxUrl:n,action:r,queryField:l,aiChatterId:m,message:M.value,prevMessage:E.value,aiChatId:p.aiChatId,nonce:i,onMessageChunk:g=>{D.value+=g,_("update:messages",{message:g,type:"system"})}}),S(D.value,"system"),E.value=D.value}catch(g){const x=g instanceof Error?g.message:"Error sending message";_("update:error-message",x)}finally{A.value=!1,M.value=""}}}function S(g,x){x==="system"&&_("update:remaining-questions",p.remainingQuestions-1),p.aiChatId&&Bt({ajaxUrl:n,action:u,nonce:i,message:g,aiChatId:p.aiChatId,role:x}),p.remainingQuestions===0&&o(!1),_("update:messages",{message:g,type:x})}return(g,x)=>(s(),c("form",{class:"tw:flex tw:mb-6 tw:sm:mb-0 tw:gap-2",onSubmit:nt(C,["prevent"]),name:"chat-footer"},[st(d("input",{type:"text",id:"message","onUpdate:modelValue":x[0]||(x[0]=O=>M.value=O),disabled:A.value||!g.allowChatInput,class:"tw:grow tw:align-center tw:border-gray-400! tw:flex tw:rounded-full! tw:border! tw:px-6! tw:pt-1! tw:pb-2! tw:text-base! tw:shadow-lg tw:disabled:opacity-30 tw:disabled:cursor-not-allowed tw:focus:outline-hidden tw:focus:ring-2 tw:focus:ring-blue-500"},null,8,ae),[[pt,M.value]]),d("button",ne,[L(ee,{class:"tw:w-6 tw:h-6 tw:text-gray-400"})])],32))}}),oe={},ie={xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 512 512"},re=d("path",{d:"M200 32H56C42.7 32 32 42.7 32 56V200c0 9.7 5.8 18.5 14.8 22.2s19.3 1.7 26.2-5.2l40-40 79 79-79 79L73 295c-6.9-6.9-17.2-8.9-26.2-5.2S32 302.3 32 312V456c0 13.3 10.7 24 24 24H200c9.7 0 18.5-5.8 22.2-14.8s1.7-19.3-5.2-26.2l-40-40 79-79 79 79-40 40c-6.9 6.9-8.9 17.2-5.2 26.2s12.5 14.8 22.2 14.8H456c13.3 0 24-10.7 24-24V312c0-9.7-5.8-18.5-14.8-22.2s-19.3-1.7-26.2 5.2l-40 40-79-79 79-79 40 40c6.9 6.9 17.2 8.9 26.2 5.2s14.8-12.5 14.8-22.2V56c0-13.3-10.7-24-24-24H312c-9.7 0-18.5 5.8-22.2 14.8s-1.7 19.3 5.2 26.2l40 40-79 79-79-79 40-40c6.9-6.9 8.9-17.2 5.2-26.2S209.7 32 200 32z"},null,-1),le=[re];function ce(t,a){return s(),c("svg",ie,le)}const de=K(oe,[["render",ce]]),ue={},we={xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 512 512"},me=d("path",{d:"M456 224H312c-13.3 0-24-10.7-24-24V56c0-9.7 5.8-18.5 14.8-22.2s19.3-1.7 26.2 5.2l40 40L442.3 5.7C446 2 450.9 0 456 0s10 2 13.7 5.7l36.7 36.7C510 46 512 50.9 512 56s-2 10-5.7 13.7L433 143l40 40c6.9 6.9 8.9 17.2 5.2 26.2s-12.5 14.8-22.2 14.8zm0 64c9.7 0 18.5 5.8 22.2 14.8s1.7 19.3-5.2 26.2l-40 40 73.4 73.4c3.6 3.6 5.7 8.5 5.7 13.7s-2 10-5.7 13.7l-36.7 36.7C466 510 461.1 512 456 512s-10-2-13.7-5.7L369 433l-40 40c-6.9 6.9-17.2 8.9-26.2 5.2s-14.8-12.5-14.8-22.2V312c0-13.3 10.7-24 24-24H456zm-256 0c13.3 0 24 10.7 24 24V456c0 9.7-5.8 18.5-14.8 22.2s-19.3 1.7-26.2-5.2l-40-40L69.7 506.3C66 510 61.1 512 56 512s-10-2-13.7-5.7L5.7 469.7C2 466 0 461.1 0 456s2-10 5.7-13.7L79 369 39 329c-6.9-6.9-8.9-17.2-5.2-26.2s12.5-14.8 22.2-14.8H200zM56 224c-9.7 0-18.5-5.8-22.2-14.8s-1.7-19.3 5.2-26.2l40-40L5.7 69.7C2 66 0 61.1 0 56s2-10 5.7-13.7L42.3 5.7C46 2 50.9 0 56 0s10 2 13.7 5.7L143 79l40-40c6.9-6.9 17.2-8.9 26.2-5.2s14.8 12.5 14.8 22.2V200c0 13.3-10.7 24-24 24H56z"},null,-1),pe=[me];function he(t,a){return s(),c("svg",we,pe)}const fe=K(ue,[["render",he]]),ge=k({__name:"chat-maximize-button",props:{isExpanded:Boolean},emits:["expand-chat"],setup(t,{emit:a}){const e=a;function o(n){n.stopPropagation(),e("expand-chat")}return(n,r)=>(s(),c("button",{onClick:r[0]||(r[0]=i=>e("expand-chat")),class:"tw:absolute tw:top-2 tw:sm:-top-12 tw:left-0 tw:hidden tw:sm:block"},[L(de,{onClick:o,class:U(["tw:h-6 tw:w-6 tw:sm:w-10 tw:sm:h-10 tw:text-blue-500",{"tw:block":!t.isExpanded,"tw:hidden!":t.isExpanded}])},null,8,["class"]),L(fe,{onClick:o,class:U(["tw:h-6 tw:w-6 tw:sm:w-10 tw:sm:h-10 tw:text-blue-500",{"tw:block":t.isExpanded,"tw:hidden!":!t.isExpanded}])},null,8,["class"])]))}}),xe={class:"tw:fixed tw:z-40 tw:inset-0 tw:w-full tw:h-full tw:bg-black tw:justify-center tw:items-center tw:flex tw:bg-opacity-50",tabindex:"-1"},ve={class:"tw:bg-white tw:rounded tw:w-full tw:max-w-lg tw:min-w-md tw:h-96 tw:flex tw:flex-col"},be={class:"tw:p-4 tw:border-b"},_e=["innerHTML"],ye={class:"tw:flex tw:justify-end tw:border-t tw:p-4"},Ce=k({__name:"chat-modal",props:{id:String,name:String,content:String,isVisible:Boolean},emits:["close-modal"],setup(t,{emit:a}){const e=a;function o(n){e("close-modal",n)}return(n,r)=>st((s(),c("div",xe,[d("div",ve,[d("header",be,B(t.name),1),d("main",{class:"tw:grow tw:p-4 tw:overflow-y-scroll",innerHTML:t.content},null,8,_e),d("footer",ye,[L(lt,{onClick:r[0]||(r[0]=i=>o(t.id))},{default:V(()=>[P("Close")]),_:1})])])],512)),[[ht,t.isVisible]])}}),$e={},ke={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"413",height:"413",viewBox:"0 0 413 413"},Ae=ft('<defs><linearGradient id="hall-9000-gradient" x1="1" y1="1" x2="0.081" y2="0.124" gradientUnits="objectBoundingBox"><stop offset="0" stop-color="#6d86d6"></stop><stop offset="1" stop-color="#48c4ee"></stop></linearGradient></defs><rect fill="url(#hall-9000-gradient)" width="413" height="413" rx="206.5"></rect><circle fill="#fff" cx="74.189" cy="74.189" r="74.189" transform="translate(131.178 134.023)"></circle><circle fill="#fff" cx="35.382" cy="35.382" r="35.382" transform="translate(278.414 96.358)"></circle><path fill="#fff" d="M132.445,0C61.11,0,2.9,58.209,2.9,129.545S61.11,259.089,132.445,259.089,261.989,200.88,261.989,129.545,203.78,0,132.445,0Zm0,245.393A115.848,115.848,0,1,1,248.293,129.545,115.932,115.932,0,0,1,132.445,245.393Z" transform="translate(72.922 76.955)"></path>',5),Me=[Ae];function Fe(t,a){return s(),c("svg",ke,Me)}const Ie=K($e,[["render",Fe]]),Ee=k({__name:"chat-open-button",props:{isOpen:Boolean},emits:["open-chat"],setup(t,{emit:a}){const e=a;return(o,n)=>(s(),c("button",{onClick:n[1]||(n[1]=r=>e("open-chat")),class:"tw:fixed tw:bottom-2 tw:right-2 tw:sm:bottom-6 tw:sm:right-6 tw:z-20"},[L(Ie,{class:"tw:w-8 tw:h-8 tw:sm:w-16 tw:sm:h-16 tw:rounded-full tw:duration-300 tw:hover:rotate-90",onClick:n[0]||(n[0]=r=>e("open-chat"))})]))}}),Se={class:"tw:absolute tw:sm:-top-12 tw:right-0 tw:items-center tw:justify-center tw:gap-2 tw:rounded-2xl tw:bg-white tw:pl-2 tw:pr-4 tw:shadow-lg tw:hidden tw:sm:flex"},je=d("div",{class:"tw:bg-blue-500 tw:h-8 tw:w-8 tw:rounded-full"},null,-1),Be=d("div",{class:"tw:relative tw:-top-1 tw:text-2xl"},"tokens left",-1),De={class:"tw:relative tw:-top-1 tw:text-4xl tw:font-bold"},Le=d("div",{class:"tw:absolute tw:bottom-2 tw:left-4 tw:sm:hidden"}," {ramainingQuestions} tokens left ",-1),Oe=k({__name:"chat-tokens",props:{ramainingQuestions:Number},setup(t){return(a,e)=>(s(),c(N,null,[d("div",Se,[je,Be,d("div",De,B(t.ramainingQuestions),1)]),Le],64))}}),qe=["innerHTML"],Te=k({__name:"chat-user-message",props:{isExpanded:Boolean,message:String},setup(t){return(a,e)=>(s(),c("div",{class:U(["tw:from-gray-200 tw:text-base tw:to-gray-300 tw:border-gray-400 tw:text-gray-700 tw:rounded-t-2xl tw:rounded-br-2xl tw:border tw:bg-linear-to-t tw:px-6 tw:pt-1 tw:pb-2",{"max-w-[700px]":t.isExpanded,"max-w-[414px]":!t.isExpanded}]),innerHTML:t.message},null,10,qe))}}),ze=k({__name:"chat-gpt",setup(t){const a=j("chatGptData");if(!a)throw new Error("chatGptData is undefined");const{isActive:e,initMessage:o,campaigns:n,limitChat:r,hasAiChat:i,ajaxUrl:l,ajaxActionCreateAiChat:m,nonce:u,aiChatCampaignsField:p,beforeFormMessage:_,questionsLimit:A,aiChatCampaigns:M,afterFormMessageSuccess:D,allowAiChatCampaigns:E}=a,C=w(!1),S=w(null),g=w(!1),x=w(A),O=w(null),q=w(!1),Q=w(!1),R=w(!1),Z=w([]),T=w(null),v=w(null);H("aiChatId",O),H("setAiChatId",h=>{O.value=h}),H("setModalIdOpen",h=>{S.value=h}),H("setIsAcceptedAiChatForm",h=>{Q.value=h}),H("setIsAcceptedAiContactForm",h=>{R.value=h}),H("setAllowChatInput",h=>{q.value=h}),H("setErrorMessage",h=>{v.value=h});async function G(h){try{const b=await jt({ajaxUrl:l,action:m,nonce:u,aiChatCampaigns:p,campaignIds:h});O.value=b.aiChatId,Q.value=!0,q.value=!0}catch(b){console.log(b)}}Y(C,()=>{C.value&&!O.value&&i&&!E&&(G([]),q.value=!0),C.value&&!i&&(Q.value=!0,q.value=!0)});const F=tt(()=>!Q.value&&i&&M.length>0),z=tt(()=>x.value===0&&!R.value&&r);function ut(h){G(h)}function wt(h){if(!h.message.includes("[DONE]"))if(h.type==="system"){const b=Z.value.at(-1);b&&b.type==="system"?b.message+=h.message:Z.value.push({message:h.message,type:"system"})}else Z.value.push({message:h.message,type:"user"})}function mt(){T.value&&(T.value.scrollTop=T.value.scrollHeight)}return Y(x,()=>{x.value===0&&(q.value=!1)}),gt(()=>{mt()}),(h,b)=>(s(),c(N,null,[f(e)?(s(),c("div",{key:0,class:U(["tw:inset-0 tw:w-full tw:h-full tw:bg-black/70 tw:justify-center tw:items-center tw:flex tw:z-20",{"tw:hidden":!C.value,"tw:fixed":C.value}])},[d("div",{class:U(["tw:relative tw:flex tw:flex-col tw:text-xl tw:w-full tw:h-full tw:min-h-full tw:p-4 tw:sm:p-6 tw:border-2 tw:sm:border-gray-300 tw:sm:rounded-3xl tw:shadow-card tw:bg-white",{"tw:sm:h-5/6 tw:sm:w-[900px] tw:sm:min-h-[600px] tw:mx-4":g.value,"tw:sm:h-4/6 tw:sm:w-[537px] tw:sm:min-h-[500px]":!g.value}])},[d("main",{class:"tw:flex tw:grow tw:flex-col tw:gap-3 tw:sm:gap-7 tw:overflow-y-auto tw:mb-4",ref_key:"chatContainer",ref:T},[F.value?(s(),y(Et,{key:0,onFormAccepted:ut})):$("",!0),Q.value?(s(),y(et,{key:1,message:f(o),isExpanded:g.value},null,8,["message","isExpanded"])):$("",!0),(s(!0),c(N,null,W(Z.value,I=>(s(),c(N,null,[I.type==="user"?(s(),y(Te,{key:0,message:I.message},null,8,["message"])):(s(),y(et,{key:1,message:I.message,isExpanded:g.value},null,8,["message","isExpanded"]))],64))),256)),z.value?(s(),y(J,{key:2,type:"warning"},{default:V(()=>[P(B(f(_)),1)]),_:1})):$("",!0),z.value?(s(),y(Zt,{key:3})):$("",!0),R.value?(s(),y(J,{key:4,type:"success"},{default:V(()=>[P(B(f(D)),1)]),_:1})):$("",!0),v.value?(s(),y(J,{key:5,type:"error"},{default:V(()=>[P(B(v.value),1)]),_:1})):$("",!0)],512),L(se,{allowChatInput:q.value,aiChatId:O.value,remainingQuestions:x.value,"onUpdate:remainingQuestions":b[0]||(b[0]=I=>x.value=I),"onUpdate:messages":wt,"onUpdate:errorMessage":b[1]||(b[1]=I=>v.value=I)},null,8,["allowChatInput","aiChatId","remainingQuestions"]),f(r)?(s(),y(Oe,{key:0,ramainingQuestions:x.value},null,8,["ramainingQuestions"])):$("",!0),L(ge,{isExpanded:g.value,onExpandChat:b[2]||(b[2]=I=>g.value=!g.value)},null,8,["isExpanded"])],2)],2)):$("",!0),f(e)?(s(!0),c(N,{key:1},W(f(n),I=>(s(),y(Ce,{name:I.name,content:I.content,id:I.id,isVisible:I.id===S.value,onCloseModal:b[3]||(b[3]=Ge=>S.value=null)},null,8,["name","content","id","isVisible"]))),256)):$("",!0),f(e)?(s(),y(Ee,{key:2,onClick:b[4]||(b[4]=I=>C.value=!C.value),isOpen:C.value},null,8,["isOpen"])):$("",!0)],64))}});let dt={};dt=window.chat_gpt.data;const Ve=xt({setup(){H("chatGptData",dt)},render:()=>vt(ze)});Ve.mount("#main_chat_gpt");
